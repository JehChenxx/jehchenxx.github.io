"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[371],{74809:function(b,h,e){e.r(h),e.d(h,{default:function(){return C}});var f=e(90228),i=e.n(f),m=e(87999),u=e.n(m),p=e(48305),A=e.n(p),v=e(22396),l=e(75271),F=e(2732),U=e(35344),t=e(52676);function c(){var j=(0,l.useState)([]),y=A()(j,2),E=y[0],T=y[1];function w(){return S.apply(this,arguments)}function S(){return S=u()(i()().mark(function s(){var d,r;return i()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.Z.from("todos").select();case 2:d=n.sent,r=d.data,r&&r.length>0&&T(function(){return r});case 5:case"end":return n.stop()}},s)})),S.apply(this,arguments)}return(0,l.useEffect)(function(){var s=(0,F.PR)();(0,U.isNil)(s)||(console.log("\u767B\u5F55\u6210\u529F\uFF0C\u73B0\u5728\u53EF\u4EE5\u83B7\u53D6 Todos \u4E86"),w())},[]),(0,t.jsx)("div",{children:E.map(function(s){return console.log(s),(0,t.jsx)("li",{children:JSON.stringify(s)},s)})})}var g=c,B=function(){var y=(0,l.useState)(null),E=A()(y,2),T=E[0],w=E[1];(0,l.useEffect)(function(){var s=function(n,a){var x;console.log("Auth Event:",n);var $=(x=a==null?void 0:a.user)!==null&&x!==void 0?x:null;w($),(n==="SIGNED_OUT"||!a)&&window.location.hash.includes("access_token")&&window.history.replaceState(null,"",window.location.pathname)};v.Z.auth.getSession().then(function(o){var n=o.data.session;n&&w(n.user)});var d=v.Z.auth.onAuthStateChange(function(o,n){s(o,n)}),r=d.data;return function(){r.subscription.unsubscribe()}},[]);var S=function(){var s=u()(i()().mark(function d(){var r,o;return i()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v.Z.auth.signOut();case 2:r=a.sent,o=r.error,o||(console.log("\u9000\u51FA\u6210\u529F\uFF0C\u6E05\u7406\u73B0\u573A..."),window.location.hash&&window.history.replaceState(null,"",window.location.pathname),window.location.href="/login");case 5:case"end":return a.stop()}},d)}));return function(){return s.apply(this,arguments)}}();return(0,t.jsx)("div",{style:{height:"calc(100vh - 140px)",padding:"20px"},children:(0,t.jsx)("div",{id:"user",style:{marginBottom:"20px",padding:"10px",borderBottom:"1px solid #ccc"},children:T?(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["\u6B22\u8FCE\u56DE\u6765, ",(0,t.jsx)("strong",{children:T.email}),"!"]}),(0,t.jsx)(g,{}),(0,t.jsx)("button",{onClick:S,children:"\u9000\u51FA\u767B\u5F55"})]}):(0,t.jsx)("p",{children:"\u5F53\u524D\u672A\u767B\u5F55\uFF0C\u8BF7\u70B9\u51FB\u53F3\u4E0A\u89D2\u767B\u5F55\u6309\u94AE\u8FDB\u884C\u767B\u5F55\u3002"})})})},C=l.memo(B)},2732:function(b,h,e){e.d(h,{Hk:function(){return v},PR:function(){return U},QS:function(){return m},kX:function(){return t}});var f=e(74296),i="https://ap-southeast-1.aws.services.cloud.mongodb.com/api/client/v2.0/app/data-erhzmlq/auth/providers/local-userpass/login",m="https://ap-southeast-1.aws.data.mongodb-api.com/app/data-erhzmlq/endpoint/data/v1/action/find",u="username",p="access_token",A=function(g){return sessionStorage.setItem(p,g)},v=function(){return sessionStorage.getItem(p)},l=function(){return sessionStorage.removeItem(p)},F=function(g,B){sessionStorage.setItem(u,g),A(B),history.push("/")},U=function(){return sessionStorage.getItem(u)},t=function(){l(),sessionStorage.removeItem(u),f.m8.push("/"),location.reload()}},22396:function(b,h,e){var f=e(19697),i="https://swxiffcmfmoowokhglyi.supabase.co",m="sb_publishable_lyX4MrLNdYVw38b74f6vCg_av6rwMiH",u=(0,f.eI)(i,m);h.Z=u}}]);
